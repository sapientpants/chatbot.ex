#!/bin/sh
#
# Pre-commit hook that runs mix precommit
# This ensures code quality checks pass before committing
#
# To install this hook, run:
#   cp .githooks/pre-commit .git/hooks/pre-commit
#   chmod +x .git/hooks/pre-commit
#
# Or use: git config core.hooksPath .githooks

echo "Running pre-commit checks..."

# Run mix precommit
mix precommit

# Capture the exit code
EXIT_CODE=$?

if [ $EXIT_CODE -ne 0 ]; then
  echo ""
  echo "❌ Pre-commit checks failed!"
  echo "Please fix the issues above before committing."
  echo ""
  echo "To bypass this hook (not recommended), use: git commit --no-verify"
  exit 1
fi

echo "✅ Pre-commit checks passed!"
exit 0
